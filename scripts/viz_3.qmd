---
title: "Visualization 5"
subtitle: "DSAN 5200 Final Project"
author: "Morgan Dreiss"
date: last-modified
date-format: long
format:
    html: 
        light: [cosmo, style/html-sta313.scss]
        dark: [cosmo, style/html-sta313.scss, style/html-dark.scss]
        toc: true
        code-copy: true
        code-overflow: wrap
        mainfont: "Atkinson Hyperlegible"
        code-annotations: hover
        embed-resources: true
        self-contained: true
        code-fold: true
execute:
    echo: true
    warning: false
    message: false
    freeze: auto
---

```{r}
#| label: load_libs
library(tidyverse) |> suppressMessages()
#remotes::install_github('vegawidget/vegabrite') |> suppressMessages()
library(vegabrite) |> suppressMessages()
library(jsonlite) |> suppressMessages()
```

```{r}
#| label: load_data

df <- read.csv('../processed_data/merged_state_obs.csv')
print(summary(df))

state_df <- df |> filter(jurisdiction != "Federal")
```
```{r}
state_df$expends_per_inmate <- state_df$total_correction_expends/state_df$total_prison_pop_22

```



```{r}
#| label: vb_scatter
vl_chart(title = "Stuff", width = 550) |>
   vl_add_data(values = state_df) |>
   vl_mark_point() |>
   vl_encode_x("mean_pay_non_industry", type = "quantitative", title = "Mean pay for prison workers") |>
   vl_encode_y("expends_per_inmate", type = "quantitative", title = "Corrections Expenditures Per Inmate") |>
   vl_encode_color(field = "total_prison_pop_22", type = "quantitative", bin= TRUE) |>
   vl_encode_tooltip_array(c("jurisdiction","total_co_employment","annual_mean_salary"))
```


```{r}
#| label: vb_bar
vl_chart(title = "Stuff", width = 550) |>
   vl_add_data(values = state_df) |>
   vl_mark_bar() |>
   vl_encode_x("mean_pay_non_industry", type = "quantitative", title = "Mean pay for prison workers") |>
   vl_encode_y("annual_mean_salary", type = "quantitative", title = "Corrections Expenditures Per Inmate") |>
   #vl_encode_color(field = "total_prison_pop_22", type = "quantitative", bin= TRUE) |>
   vl_encode_tooltip_array(c("jurisdiction","total_co_employment","annual_mean_salary"))
```
